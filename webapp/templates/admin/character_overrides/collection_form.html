{% extends "admin/base.html" %}

{% set active_nav = 'character_overrides' %}

{% block title %}{{ 'Create' if action == 'create' else 'Edit' }} Collection - Admin - WriteBot{% endblock %}

{% block admin_title %}{{ 'Create New Collection' if action == 'create' else 'Edit Collection' }}{% endblock %}

{% block admin_header_actions %}
<a href="{{ url_for('character_overrides.list_collections') }}" class="btn btn-ghost">Back to Collections</a>
{% endblock %}

{% block admin_content %}
<div class="admin-section">
    <div class="admin-section__header">
        <div>
            <h2 class="admin-section__title">Collection Details</h2>
            <p class="admin-section__subtitle">
                {% if action == 'create' %}
                Create a new character override collection to store custom handwriting variants
                {% else %}
                Update the details and settings for this collection
                {% endif %}
            </p>
        </div>
    </div>

    <form method="POST" data-validate>
        <div class="form-group">
            <label for="name">Collection Name *</label>
            <input type="text"
                   id="name"
                   name="name"
                   value="{{ collection.name if collection else '' }}"
                   required
                   autofocus>
            <div class="help-text">A unique, descriptive name for this character override collection.</div>
        </div>

        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description"
                      name="description"
                      rows="4">{{ collection.description if collection else '' }}</textarea>
            <div class="help-text">Optional description to help identify the purpose and characteristics of this collection.</div>
        </div>

        <div class="form-check">
            <input type="checkbox"
                   id="is_active"
                   name="is_active"
                   {{ 'checked' if not collection or collection.is_active else '' }}>
            <label for="is_active">Active (available for use in handwriting generation)</label>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                {% if action == 'create' %}
                Create Collection
                {% else %}
                Update Collection
                {% endif %}
            </button>
            <a href="{{ url_for('character_overrides.list_collections') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

{% if collection %}
<div class="admin-section">
    <div class="admin-section__header">
        <div>
            <h2 class="admin-section__title">Collection Statistics</h2>
            <p class="admin-section__subtitle">Current status and usage information</p>
        </div>
    </div>

    <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
        <div class="stat-card">
            <div class="stat-card__label">Unique Characters</div>
            <div class="stat-card__value">{{ collection.get_unique_characters()|length }}</div>
        </div>
        <div class="stat-card">
            <div class="stat-card__label">Total Variants</div>
            <div class="stat-card__value">{{ collection.get_character_count() }}</div>
        </div>
        <div class="stat-card">
            <div class="stat-card__label">Status</div>
            <div class="stat-card__value" style="font-size: 18px; margin-top: 8px;">
                {% if collection.is_active %}
                <span class="badge badge-active">Active</span>
                {% else %}
                <span class="badge badge-inactive">Inactive</span>
                {% endif %}
            </div>
        </div>
    </div>

    <div style="margin-top: 24px; text-align: center;">
        <a href="{{ url_for('character_overrides.view_collection', collection_id=collection.id) }}"
           class="btn btn-primary">
            View & Manage Characters
        </a>
    </div>
</div>
{% endif %}
{% endblock %}
