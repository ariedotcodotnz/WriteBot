{% extends "admin/base.html" %}

{% set active_nav = 'activities' %}

{% block title %}Activity Log - Admin - WriteBot{% endblock %}

{% block admin_title %}Activity Log{% endblock %}

{% block admin_content %}
<div class="admin-section">
    <div class="admin-section__header">
        <div>
            <h2 class="admin-section__title">Activity Log</h2>
            <p class="admin-section__subtitle">Complete history of all user actions and events</p>
        </div>
    </div>

    {% if activities %}
    <table class="admin-table">
        <thead>
            <tr>
                <th>User</th>
                <th>Activity Type</th>
                <th>Description</th>
                <th>IP Address</th>
                <th>Timestamp</th>
            </tr>
        </thead>
        <tbody>
            {% for activity in activities %}
            <tr>
                <td>
                    <a href="{{ url_for('admin.view_user', user_id=activity.user_id) }}"
                       style="color: #0f62fe; text-decoration: none; font-weight: 500;">
                        {{ activity.user.username }}
                    </a>
                </td>
                <td><span class="badge badge-{{ activity.activity_type }}">{{ activity.activity_type }}</span></td>
                <td>{{ activity.description or '-' }}</td>
                <td><code style="font-size: 12px; color: #6f6f6f;">{{ activity.ip_address or '-' }}</code></td>
                <td>{{ activity.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if pagination %}
    <div class="pagination">
        {% if pagination.has_prev %}
        <a href="{{ url_for('admin.activities', page=pagination.prev_num) }}">Previous</a>
        {% endif %}

        {% for page in pagination.iter_pages() %}
            {% if page %}
                {% if page == pagination.page %}
                <span class="current">{{ page }}</span>
                {% else %}
                <a href="{{ url_for('admin.activities', page=page) }}">{{ page }}</a>
                {% endif %}
            {% else %}
            <span>...</span>
            {% endif %}
        {% endfor %}

        {% if pagination.has_next %}
        <a href="{{ url_for('admin.activities', page=pagination.next_num) }}">Next</a>
        {% endif %}
    </div>
    {% endif %}
    {% else %}
    <div class="empty-state">
        <div class="empty-state__message">No activities recorded yet.</div>
    </div>
    {% endif %}
</div>
{% endblock %}
