{% extends "admin/base.html" %}

{% set active_nav = 'statistics' %}

{% block title %}Statistics - Admin - WriteBot{% endblock %}

{% block admin_title %}Usage Statistics{% endblock %}

{% block admin_content %}
{# Aggregated Statistics by Period #}
<div class="admin-section">
    <div class="admin-section__header">
        <div>
            <h2 class="admin-section__title">Usage Statistics</h2>
            <p class="admin-section__subtitle">Aggregated metrics across different time periods</p>
        </div>
    </div>

    <div class="period-tabs">
        <div class="period-card">
            <h3>Last 7 Days</h3>
            <div class="stat-row">
                <span class="label">SVG Generations</span>
                <span class="value">{{ stats_7d.svg_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Batch Generations</span>
                <span class="value">{{ stats_7d.batch_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Lines</span>
                <span class="value">{{ stats_7d.total_lines }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Characters</span>
                <span class="value">{{ stats_7d.total_characters }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Processing Time</span>
                <span class="value">{{ "%.1f"|format(stats_7d.total_processing_time) }}s</span>
            </div>
        </div>

        <div class="period-card">
            <h3>Last 30 Days</h3>
            <div class="stat-row">
                <span class="label">SVG Generations</span>
                <span class="value">{{ stats_30d.svg_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Batch Generations</span>
                <span class="value">{{ stats_30d.batch_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Lines</span>
                <span class="value">{{ stats_30d.total_lines }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Characters</span>
                <span class="value">{{ stats_30d.total_characters }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Processing Time</span>
                <span class="value">{{ "%.1f"|format(stats_30d.total_processing_time) }}s</span>
            </div>
        </div>

        <div class="period-card">
            <h3>Last 90 Days</h3>
            <div class="stat-row">
                <span class="label">SVG Generations</span>
                <span class="value">{{ stats_90d.svg_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Batch Generations</span>
                <span class="value">{{ stats_90d.batch_generations }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Lines</span>
                <span class="value">{{ stats_90d.total_lines }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Total Characters</span>
                <span class="value">{{ stats_90d.total_characters }}</span>
            </div>
            <div class="stat-row">
                <span class="label">Processing Time</span>
                <span class="value">{{ "%.1f"|format(stats_90d.total_processing_time) }}s</span>
            </div>
        </div>
    </div>
</div>

{# Daily Statistics Table #}
<div class="admin-section">
    <div class="admin-section__header">
        <div>
            <h2 class="admin-section__title">Daily Statistics (Last 30 Days)</h2>
            <p class="admin-section__subtitle">Day-by-day breakdown of platform usage</p>
        </div>
    </div>

    {% if daily_stats %}
    <table class="admin-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>SVG Generations</th>
                <th>Batch Generations</th>
                <th>Total Lines</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in daily_stats %}
            <tr>
                <td><strong>{{ stat.date }}</strong></td>
                <td>{{ stat.svg or 0 }}</td>
                <td>{{ stat.batch or 0 }}</td>
                <td>{{ stat.lines or 0 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <div class="empty-state__message">No statistics available for the selected period.</div>
    </div>
    {% endif %}
</div>
{% endblock %}
