{% extends "admin/base.html" %}

{% set active_nav = 'page_sizes' %}

{% block title %}Page Size Presets - WriteBot Admin{% endblock %}

{% block admin_title %}Page Size Presets{% endblock %}

{% block admin_header_actions %}
    <a href="{{ url_for('presets.create_page_size') }}" class="bx--btn bx--btn--primary">Create Page Size</a>
    <a href="{{ url_for('index') }}" class="bx--btn bx--btn--tertiary">Back to App</a>
{% endblock %}

{% block admin_content %}
{# Search Bar using Carbon components #}
<div class="admin-section">
    <form method="get" class="bx--form" hx-get="{{ url_for('presets.list_page_sizes') }}" hx-trigger="submit" hx-target="#page-sizes-table" hx-swap="outerHTML">
        <div class="bx--search bx--search--lg" data-search>
            <label for="search-input" class="bx--label bx--visually-hidden">Search</label>
            <input type="text"
                   id="search-input"
                   name="search"
                   class="bx--search-input"
                   placeholder="Search page sizes..."
                   value="{{ search_query if search_query else '' }}">
            <svg class="bx--search-magnifier" width="16" height="16" viewBox="0 0 16 16">
                <path d="M15 14.3L10.7 10c1.1-1.1 1.8-2.7 1.8-4.4C12.5 2.5 9.9 0 6.7 0S1 2.5 1 5.6 3.6 11.2 6.8 11.2c1.7 0 3.2-.7 4.4-1.8L15.7 14 15 14.3zM6.8 1.5c2.3 0 4.2 1.9 4.2 4.2s-1.9 4.2-4.2 4.2S2.5 8 2.5 5.7s1.9-4.2 4.3-4.2z"/>
            </svg>
            <button class="bx--search-close bx--search-close--hidden" type="button" title="Clear search">
                <svg width="16" height="16" viewBox="0 0 16 16">
                    <path d="M12 4.7L11.3 4 8 7.3 4.7 4 4 4.7 7.3 8 4 11.3l.7.7L8 8.7l3.3 3.3.7-.7L8.7 8z"/>
                </svg>
            </button>
        </div>
        {% if search_query %}
        <a href="{{ url_for('presets.list_page_sizes') }}" class="bx--btn bx--btn--ghost bx--btn--sm" style="margin-left: 1rem;">Clear</a>
        {% endif %}
    </form>
</div>

{# Page Sizes Table using Carbon Data Table #}
<div class="admin-section" id="page-sizes-table">
    {% if page_sizes %}
    <div class="bx--data-table-container">
        <table class="bx--data-table bx--data-table--zebra">
            <thead>
                <tr>
                    <th><span class="bx--table-header-label">Name</span></th>
                    <th><span class="bx--table-header-label">Description</span></th>
                    <th><span class="bx--table-header-label">Dimensions (mm)</span></th>
                    <th><span class="bx--table-header-label">Type</span></th>
                    <th><span class="bx--table-header-label">Status</span></th>
                    <th><span class="bx--table-header-label">Actions</span></th>
                </tr>
            </thead>
            <tbody>
                {% for preset in page_sizes %}
                <tr>
                    <td>
                        <strong>{{ preset.name }}</strong>
                    </td>
                    <td>{{ preset.description or '-' }}</td>
                    <td>{{ preset.width }} Ã— {{ preset.height }}</td>
                    <td>
                        {% if preset.is_default %}
                        <span class="bx--tag bx--tag--blue">Default</span>
                        {% else %}
                        <span class="bx--tag bx--tag--gray">Custom</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if preset.is_active %}
                        <span class="bx--tag bx--tag--green">Active</span>
                        {% else %}
                        <span class="bx--tag bx--tag--warm-gray">Inactive</span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="bx--btn-set">
                            <a href="{{ url_for('presets.edit_page_size', preset_id=preset.id) }}"
                               class="bx--btn bx--btn--sm bx--btn--tertiary">Edit</a>
                            {% if not preset.is_default %}
                            <button type="button"
                                    class="bx--btn bx--btn--sm bx--btn--danger--tertiary"
                                    hx-post="{{ url_for('presets.delete_page_size', preset_id=preset.id) }}"
                                    hx-confirm="Are you sure you want to delete this page size?"
                                    hx-target="closest tr"
                                    hx-swap="outerHTML swap:1s">
                                Delete
                            </button>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="bx--tile" style="text-align: center; padding: 3rem;">
        <h4>No page size presets found</h4>
        {% if search_query %}
        <p>Try adjusting your search query.</p>
        {% else %}
        <p style="margin-bottom: 1.5rem;">Get started by creating your first page size preset.</p>
        <a href="{{ url_for('presets.create_page_size') }}" class="bx--btn bx--btn--primary">Create First Page Size</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
